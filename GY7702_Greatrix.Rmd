
---
title: GY7702 Assignment
subtitle: MSc Satellite Data Science at the University of Leicester
author: Elliot Greatrix
date: 04/11/2020
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
rm(list = ls())
```

# Introduction 

This document was created to meet the requirements of GY7702 R for Data 
Science at University of Leicester. It was designed and created in R Markdown, a 
markup language that allows users to create documents that can be formatted to embed code blocks, code outputs and hyperlinks.
When the R Markdown file is compiled, the markup language is hidden and the document is displayed in plain text.

This content was created using [R](https://www.r-project.org/), [Rstudio](https://rstudio.com/), [RMarkdown](https://rmarkdown.rstudio.com/) and [GitHub](https://github.com/)

## Materials 

The libraries used in this assignment: 
```{r load_libraries, warning=FALSE, message=FALSE}
library(tidyverse)
library(palmerpenguins)
library(dplyr)
library(knitr)
library(readr)
library(tinytex)
library(lubridate)
```

For further information regarding the source code, data and libraries used in this assignment, please see the [projects GitHub page](https://github.com/Elliot-JG/GY7702_assignment). 

## References
Elliot would like to acknowledge that this document includes teaching materials from Dr Stefano De Sabbato for the module 
[GY7702 R for Data Science](https://le.ac.uk/modules/2020/gy7702). Dr Stefanos teaching materials can be found [here](https://sdesabbata.github.io/granolarr/)  

R for Data Science by Garrett Grolemund and Hadley Wickham, Oâ€™Reilly Media, 2016. [See online book](https://r4ds.had.co.nz/)  


### Note to reader
Where a function is mentioned for the **first time**, a brief explanation will be given before the code block. 
Thereafter, this explanation will be dismissed. 

# Question 1

A vector of 25 numbers between 1 and 7 are listed below. These values represent
answers to a survey question 

## NA 3 4 4 5 2 4 NA 6 3 5 4 0 5 7 5 NA 5 2 4 NA 3 3 5 NA

*  1 = Completely disagree
*  2 = Disagree
*  3 = Somehow disagree
*  4 = Neither agree or disagree
*  5 = Somehow agree
*  6 = Agree
*  7 = Completely agree
* NA = missing value


## Question 1.1 

Write the code necessary to check whether all participants to the survey either 
completely disagree or completely agree, once the missing values are excluded

 
```{r}
# First, let's create the vector.
num <- c(NA, 3, 4, 4, 5, 2, 4, NA, 6, 3, 5, 4, 0, 5, 7, 5, NA, 5, 2, 4, NA, 3, 3, 5, NA)

# Then, remove missing values.
num <- na.omit(num)

# And finally check whether all students either completely agree (= 7).
students_agree_complete <- all(num == 7)
```
```{r, echo=FALSE, message=FALSE}
print(students_agree_complete)
```


```{r}
# Or completely disagree (=1).
students_disagree_complete <- all(num == 1)
```
```{r, echo=FALSE, message=FALSE}
print(students_disagree_complete)
```

## Question 1.2

**Write the code necessary to extract the indexes related to the participants 
in the survey who at least somehow agree or more.**

In the vector ```num```, ```which``` students selected values between 5 and 7. 
```{r}
students_agree <- which(num %in% c(5:7))
```

# Question 2

## Question 2.2

**Write the code necessary to create a table showing species, island, bill length and body mass
of the 10 Gentoo penguins in the penguins table with the highest body mass**

The library [```palmerpenguins```](https://allisonhorst.github.io/palmerpenguins/articles/intro.html) was created by Dr. Kristen Gorman and holds 2 data sets. For this assignment, we will work with ```penguins```, a table containing 8 measured variables from 344 penguins! 

Some of the penguins in ```penguins``` hold NA values for certain variables. 
Due to the analysis that we are going to do, these need to be removed
```{r}
pen <- na.omit(penguins)
```

As this task requires multiple steps, it will be more efficient to start a pipe.
Lets send the *na omitted* table, ```pen``` down the pipe.

It is important to note that the functions in the pipe operator do not require the first argument, ```pen``` because it is being 'fed down' the pipe. For more information on pipes, click [here](https://www.rdocumentation.org/packages/magrittr/versions/1.5/topics/%25%3E%25)
```{r}
pen %>%
  # First, let's select all the variables that the question asks for
  select(species, island, bill_length_mm, bill_depth_mm, body_mass_g)%>%
  
  # and select all the 'Gentoo' penguins.
  filter(species == "Gentoo")%>%
  
  # Order body mass in ascending order
  arrange(-body_mass_g)%>%
  
  # Return the 10 heaviest Gentoo penguins 
  slice_head(n = 10)

```



## Question 2.3

**write the code necessary to create a table showing the 
average bill length per island, ordered by average bill length.**

As this question states ```per island```, we will use ```group_by``` to perform an average bill length for each island. 
We will also see ```mean()``` to determine average. This is a function built into R.

After the data set is grouped by island, average bill length will be calculated.
The result will be appended to ```pen``` in a column called ```avg_bill_length``` using the ```mutate``` function.
```{r}
pen %>%
  
  # Select the appropriate attributes
  select(species, island, bill_length_mm, bill_depth_mm,)%>%
  
  # Order by bill_length_mm. By default arrange sorts in ascending order.
  arrange(bill_length_mm)%>%
  
  # Use group_by to execute the average for each island
  group_by(island)%>%
  
  # Append the average bill_length_mm to the table pen
  mutate(avg_bill_length_mm = mean(bill_length_mm))%>%
  
  # Display 3 example average_bill_lengths for each island 
  slice_head(n = 3)%>%
kable()
```


## Question 2.4 

**Write the code necessary to create a table showing the minimum, median and maximum
proportion between bill length and bill depth by species.**

The *proportion between bill length and bill depth* will be calculated as 
```bill_length_mm``` / ```bill_depth_mm```. This will return a unit-less
measure which will be called ```bl_bd```

R also contains inbuilt functions for obtaining the minimum, median and maximum 
values from a vector. So by example after ```select()``` and ```group_by()```,  lets take the minimum ```bill_length_mm``` and 
minimum ```bill_depth_mm``` and divide them to get the unit-less measurement ```min_bl_bd```. 

```{r, eval=FALSE}
  pen %>%
  # Select the necessary attributes 
  select(species, island, bill_length_mm, bill_depth_mm,)%>%
  
  # Execute the proportions for each species
  group_by(species)%>%
  
  # Append the proportions to the table pen, using mutate
  mutate(min_bl_bd = min(bill_length_mm) / min(bill_depth_mm))%>%
```

Then repeat this for the  median and maximum values  

```{r, eval=FALSE}
  mutate(med_bl_bd = median(bill_length_mm) / median(bill_depth_mm))%>%
  mutate(max_bl_bd = max(bill_length_mm) / max(bill_depth_mm))%>%
  
  # Drop bill_length_mm and bill_depth_mm 
  subset(select = -c(bill_length_mm, bill_depth_mm))
```

This is a preview of 3 penguins from each island, demonstrating how the proportions are calculated *per island*. 
```{r, echo = FALSE}
pen %>%
  select(species, island, bill_length_mm, bill_depth_mm,)%>%
  group_by(species)%>%
  mutate(min_bl_bd = min(bill_length_mm) / min(bill_depth_mm))%>%
  mutate(med_bl_bd = median(bill_length_mm) / median(bill_depth_mm))%>%
  mutate(max_bl_bd = max(bill_length_mm) / max(bill_depth_mm))%>%
  subset(select = -c(bill_length_mm, bill_depth_mm))%>%
  slice_head(n = 3)%>%
kable()
```

# Question 3

## Question 3.1

**Write the code necessary to load the data from** ***covid19_cases_20200301_20201017.csv*** **to a variable named covid_data**
  
The library ```readr``` contains the function ```read_csv()``` which allows us to read .csv (comma-separated value) files into R. 
```{r, eval=FALSE}
# Reading the COVID-19 .csv from a local directory 
covid_data <- read_csv("C:/.../data/covid19_cases_20200301_20201017.csv")

```

```{r, echo=FALSE, message=FALSE}
covid_data <- read_csv("C:/Users/44792/Desktop/R for data science/covid19_cases_20200301_20201017.csv")
```

##  Question 3.2 

Write the code necessary to 

* Create a complete table, containing a row for each day and area
* Replace NA values with the value available for the previous date
* Replace the remaining NA values with zero 
* Subset only the area assigned to me (Dudley) 
* Drop the ```area_name``` column
*  Store the resulting table in a variable named ```[Dudley]_complete_covid_data```

First, lets check how the data is delivered. We want each row to contain a date and an area
```{r}
kable((covid_data[1:10,]), "simple")
```

This looks good, a date (```specimen_date```) and an area (```area_name```) is found on one row. 
A further look at the data shows us that the table runs through all areas (with a case) for ```2020-03-01```. This is then repeated for ```2020-03-02```
```{r, echo=FALSE, message=FALSE}
kable((covid_data[108:113,]), "simple")
```

The question also asks for a check for NA values
```{r}
covid_data_na <- any(is.na(covid_data))
```
```{r, echo=FALSE, message=FALSE}
print(covid_data_na)
```

So, the table contains no NA values. We can subset the ```area_name``` column to return only row that contain the string *Dudley*
```{r}
Dudley_complete_covid_data <- 
  covid_data %>% 
  filter(area_name == "Dudley")%>%
  subset(select = -c(area_name))
```
```{r, echo=FALSE, message=FALSE}
kable((Dudley_complete_covid_data[1:10,]), "simple")
```


# Question 3.3

**Starting from the table [area]_complete_covid_data created for Question 3.2 :**

* Create a copy of Dudley_complete_covid_data, i.e., as another variable named Dudley_day_before.
* Use the library [lubridate](https://lubridate.tidyverse.org/) to create a new column named day_before in the new table
[area]_day_before that reports the day before the day reported in the column specimen_date, as a
character value (e.g., if specimen_date is "2020-10-10", day_before should be "2020-10-09")
* Drop the specimen_date and cumCasesBySpecimenDate columns from the [area]_day_before table
* Rename the newCasesBySpecimenDate column of the the [area]_day_before table to newCases_day_before
* Join [area]_day_before with [area]_complete_covid_data, where the column specimen_date of
[area]_complete_covid_data is equal to the column day_before of [area]_day_before
* Calculate a new column in the joined table, containing the number of new cases as a percentage of the
number of new cases of the day before
* Store the resulting table in a variable named [area]_covid_development.




```{r}

```

```{r, echo=FALSE}
rm(list = ls())
```





